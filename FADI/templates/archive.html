<!-- wp:template-part {"slug":"header","tagName":"header"} /-->

<!-- wp:group {"tagName":"main","style":{"spacing":{"padding":{"top":"var:preset|spacing|50","bottom":"var:preset|spacing|50"}}},"layout":{"type":"constrained"}} -->
<main class="wp-block-group" style="padding-top:var(--wp--preset--spacing--50);padding-bottom:var(--wp--preset--spacing--50)">
    
    <!-- wp:group {"align":"wide","layout":{"type":"default"}} -->
    <div class="wp-block-group alignwide">
        
        <!-- عنوان الأرشيف -->
        <!-- wp:group {"style":{"spacing":{"margin":{"bottom":"var:preset|spacing|40"},"padding":{"all":"var:preset|spacing|30"}},"color":{"background":"#fff"}},"className":"archive-header","layout":{"type":"default"}} -->
        <div class="wp-block-group archive-header has-background" style="background-color:#fff;margin-bottom:var(--wp--preset--spacing--40);padding:var(--wp--preset--spacing--30)">
            
            <!-- wp:query-title {"type":"archive","level":1,"style":{"typography":{"fontSize":"2.2rem","fontWeight":"700"},"color":{"text":"#333"},"spacing":{"margin":{"bottom":"var:preset|spacing|20"}}}} /-->
            
            <!-- وصف الأرشيف -->
            <!-- wp:term-description {"style":{"typography":{"fontSize":"1.1rem"},"color":{"text":"#666"},"spacing":{"margin":{"bottom":"var:preset|spacing|20"}}}} /-->
            
            <!-- معلومات الأرشيف -->
            <!-- wp:group {"style":{"spacing":{"padding":{"all":"var:preset|spacing|15"}},"color":{"background":"#f8f9fa"}},"layout":{"type":"flex","flexWrap":"wrap","justifyContent":"space-between"}} -->
            <div class="wp-block-group has-background" style="background-color:#f8f9fa;padding:var(--wp--preset--spacing--15)">
                
                <!-- wp:paragraph {"style":{"typography":{"fontSize":"0.9rem"},"color":{"text":"#666"}}} -->
                <p style="color:#666;font-size:0.9rem">📁 عدد المقالات: <?php echo wp_count_posts()->publish; ?></p>
                <!-- /wp:paragraph -->
                
                <!-- wp:paragraph {"style":{"typography":{"fontSize":"0.9rem"},"color":{"text":"#666"}}} -->
                <p style="color:#666;font-size:0.9rem">📅 آخر تحديث: <?php echo get_the_modified_date('Y-m-d'); ?></p>
                <!-- /wp:paragraph -->
                
                <?php if (is_user_logged_in()): ?>
                <!-- wp:paragraph {"style":{"typography":{"fontSize":"0.9rem"},"color":{"text":"#666"}}} -->
                <p style="color:#666;font-size:0.9rem">➕ <a href="/wp-admin/post-new.php">إضافة مقال جديد</a></p>
                <!-- /wp:paragraph -->
                <?php endif; ?>
                
            </div>
            <!-- /wp:group -->
            
        </div>
        <!-- /wp:group -->
        
        <!-- قائمة المقالات -->
        <!-- wp:query {"queryId":0,"query":{"perPage":10,"pages":0,"offset":0,"postType":"post","order":"desc","orderBy":"date","author":"","search":"","exclude":[],"sticky":"","inherit":true}} -->
        <div class="wp-block-query">
            
            <!-- wp:post-template {"style":{"spacing":{"blockGap":"var:preset|spacing|30"}},"layout":{"type":"grid","columnCount":1}} -->
            <!-- wp:group {"style":{"spacing":{"padding":{"all":"var:preset|spacing|30"}},"color":{"background":"#fff"}},"className":"post-item","layout":{"type":"default"}} -->
            <div class="wp-block-group post-item has-background" style="background-color:#fff;padding:var(--wp--preset--spacing--30)">
                
                <!-- wp:group {"layout":{"type":"flex","flexWrap":"wrap","justifyContent":"space-between"}} -->
                <div class="wp-block-group">
                    
                    <!-- wp:group {"layout":{"type":"default"}} -->
                    <div class="wp-block-group">
                        
                        <!-- wp:post-title {"level":2,"isLink":true,"style":{"typography":{"fontSize":"1.4rem","fontWeight":"600"},"color":{"text":"#333"},"spacing":{"margin":{"bottom":"var:preset|spacing|10"}}}} /-->
                        
                        <!-- wp:post-excerpt {"moreText":"اقرأ المزيد →","style":{"typography":{"fontSize":"1rem"},"color":{"text":"#666"},"spacing":{"margin":{"bottom":"var:preset|spacing|15"}}}} /-->
                        
                    </div>
                    <!-- /wp:group -->
                    
                    <!-- wp:post-featured-image {"width":"120px","height":"80px","style":{"border":{"radius":"5px"}}} /-->
                    
                </div>
                <!-- /wp:group -->
                
                <!-- معلومات المقال -->
                <!-- wp:group {"style":{"spacing":{"padding":{"top":"var:preset|spacing|15"}},"border":{"top":{"color":"#e1e5e9","width":"1px"}}},"layout":{"type":"flex","flexWrap":"wrap","justifyContent":"space-between"}} -->
                <div class="wp-block-group" style="border-top-color:#e1e5e9;border-top-width:1px;padding-top:var(--wp--preset--spacing--15)">
                    
                    <!-- wp:group {"layout":{"type":"flex","flexWrap":"nowrap"}} -->
                    <div class="wp-block-group">
                        
                        <!-- wp:post-date {"style":{"typography":{"fontSize":"0.85rem"},"color":{"text":"#888"}}} /-->
                        
                        <!-- wp:post-author {"showAvatar":false,"style":{"typography":{"fontSize":"0.85rem"},"color":{"text":"#888"}}} /-->
                        
                        <!-- wp:post-terms {"term":"category","style":{"typography":{"fontSize":"0.85rem"},"color":{"text":"#667eea"}}} /-->
                        
                    </div>
                    <!-- /wp:group -->
                    
                    <?php if (is_user_logged_in()): ?>
                    <!-- wp:group {"layout":{"type":"flex","flexWrap":"nowrap"}} -->
                    <div class="wp-block-group">
                        
                        <!-- wp:paragraph {"style":{"typography":{"fontSize":"0.85rem"},"color":{"text":"#888"}}} -->
                        <p style="color:#888;font-size:0.85rem">✏️ <a href="<?php echo get_edit_post_link(); ?>">تعديل</a></p>
                        <!-- /wp:paragraph -->
                        
                    </div>
                    <!-- /wp:group -->
                    <?php endif; ?>
                    
                </div>
                <!-- /wp:group -->
                
            </div>
            <!-- /wp:group -->
            <!-- /wp:post-template -->
            
            <!-- عدم وجود مقالات -->
            <!-- wp:query-no-results -->
            <!-- wp:group {"style":{"spacing":{"padding":{"all":"var:preset|spacing|40"}},"color":{"background":"#fff"}},"layout":{"type":"default"}} -->
            <div class="wp-block-group has-background" style="background-color:#fff;padding:var(--wp--preset--spacing--40)">
                
                <!-- wp:heading {"textAlign":"center","level":3,"style":{"color":{"text":"#666"}}} -->
                <h3 class="wp-block-heading has-text-align-center" style="color:#666">لا توجد مقالات في هذا القسم</h3>
                <!-- /wp:heading -->
                
                <!-- wp:paragraph {"align":"center","style":{"color":{"text":"#888"}}} -->
                <p class="has-text-align-center" style="color:#888">لم يتم العثور على أي مقالات في هذا التصنيف. جرب البحث في أقسام أخرى.</p>
                <!-- /wp:paragraph -->
                
                <?php if (is_user_logged_in()): ?>
                <!-- wp:buttons {"layout":{"type":"flex","justifyContent":"center"}} -->
                <div class="wp-block-buttons">
                    
                    <!-- wp:button {"backgroundColor":"primary","textColor":"white"} -->
                    <div class="wp-block-button">
                        <a class="wp-block-button__link has-white-color has-primary-background-color has-text-color has-background wp-element-button" href="/wp-admin/post-new.php">إضافة مقال جديد</a>
                    </div>
                    <!-- /wp:button -->
                    
                </div>
                <!-- /wp:buttons -->
                <?php endif; ?>
                
            </div>
            <!-- /wp:group -->
            <!-- /wp:query-no-results -->
            
            <!-- التنقل بين الصفحات -->
            <!-- wp:query-pagination {"layout":{"type":"flex","justifyContent":"center"}} -->
            <!-- wp:query-pagination-previous {"label":"الصفحة السابقة"} /-->
            
            <!-- wp:query-pagination-numbers /-->
            
            <!-- wp:query-pagination-next {"label":"الصفحة التالية"} /-->
            <!-- /wp:query-pagination -->
            
        </div>
        <!-- /wp:query -->
        
        <!-- أزرار التنقل -->
        <!-- wp:group {"style":{"spacing":{"margin":{"top":"var:preset|spacing|40"}}},"layout":{"type":"default"}} -->
        <div class="wp-block-group" style="margin-top:var(--wp--preset--spacing--40)">
            
            <!-- wp:buttons {"layout":{"type":"flex","justifyContent":"center"}} -->
            <div class="wp-block-buttons">
                
                <!-- wp:button {"backgroundColor":"primary","textColor":"white","style":{"border":{"radius":"5px"}}} -->
                <div class="wp-block-button">
                    <a class="wp-block-button__link has-white-color has-primary-background-color has-text-color has-background wp-element-button" href="/dashboard/" style="border-radius:5px">🏠 لوحة التحكم</a>
                </div>
                <!-- /wp:button -->
                
                <!-- wp:button {"backgroundColor":"secondary","textColor":"white","style":{"border":{"radius":"5px"}}} -->
                <div class="wp-block-button">
                    <a class="wp-block-button__link has-white-color has-secondary-background-color has-text-color has-background wp-element-button" href="/" style="border-radius:5px">🌐 الصفحة الرئيسية</a>
                </div>
                <!-- /wp:button -->
                
            </div>
            <!-- /wp:buttons -->
            
        </div>
        <!-- /wp:group -->
        
        <!-- إحصائيات الأرشيف للمستخدمين المسجلين -->
        <?php if (is_user_logged_in()): ?>
        
        <!-- wp:group {"style":{"spacing":{"margin":{"top":"var:preset|spacing|40"},"padding":{"all":"var:preset|spacing|20"}},"color":{"background":"#f0fdf4","text":"#166534"}},"className":"archive-stats","layout":{"type":"default"}} -->
        <div class="wp-block-group archive-stats has-text-color has-background" style="color:#166534;background-color:#f0fdf4;margin-top:var(--wp--preset--spacing--40);padding:var(--wp--preset--spacing--20)">
            
            <!-- wp:heading {"level":4,"style":{"color":{"text":"#166534"},"typography":{"fontSize":"1rem","fontWeight":"600"}}} -->
            <h4 style="color:#166534;font-size:1rem;font-weight:600">📊 إحصائيات الأرشيف</h4>
            <!-- /wp:heading -->
            
            <!-- wp:columns -->
            <div class="wp-block-columns">
                
                <!-- wp:column -->
                <div class="wp-block-column">
                    <p><strong>إجمالي المقالات:</strong> <?php echo wp_count_posts()->publish; ?></p>
                </div>
                <!-- /wp:column -->
                
                <!-- wp:column -->
                <div class="wp-block-column">
                    <p><strong>المسودات:</strong> <?php echo wp_count_posts()->draft; ?></p>
                </div>
                <!-- /wp:column -->
                
                <!-- wp:column -->
                <div class="wp-block-column">
                    <p><strong>آخر مقال:</strong> <?php 
                    $latest_post = get_posts(['numberposts' => 1]);
                    echo $latest_post ? get_the_date('Y-m-d', $latest_post[0]) : 'لا يوجد';
                    ?></p>
                </div>
                <!-- /wp:column -->
                
            </div>
            <!-- /wp:columns -->
            
        </div>
        <!-- /wp:group -->
        
        <?php endif; ?>
        
    </div>
    <!-- /wp:group -->
    
</main>

<!-- wp:template-part {"slug":"footer","tagName":"footer"} /-->

<!-- تحسينات CSS إضافية للأرشيف -->
<style>
.archive-header,
.post-item {
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.post-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
}

.post-item h2 a {
    text-decoration: none;
    color: #333;
    transition: color 0.3s ease;
}

.post-item h2 a:hover {
    color: #667eea;
}

/* تحسين التنقل بين الصفحات */
.wp-block-query-pagination {
    margin-top: 40px;
}

.wp-block-query-pagination a {
    background: #fff;
    color: #333;
    padding: 10px 15px;
    border: 1px solid #e1e5e9;
    border-radius: 5px;
    text-decoration: none;
    margin: 0 5px;
    transition: all 0.3s ease;
}

.wp-block-query-pagination a:hover {
    background: #667eea;
    color: white;
    border-color: #667eea;
}

.wp-block-query-pagination .current {
    background: #667eea;
    color: white;
    border-color: #667eea;
}

/* تحسين للشاشات الصغيرة */
@media (max-width: 768px) {
    .post-item .wp-block-group {
        flex-direction: column;
    }
    
    .post-item .wp-block-post-featured-image {
        order: -1;
        width: 100% !important;
        height: 200px !important;
        margin-bottom: 15px;
    }
    
    .wp-block-buttons {
        flex-direction: column;
        align-items: center;
    }
    
    .wp-block-button {
        width: 100%;
        max-width: 250px;
        margin-bottom: 10px;
    }
}
</style>